{% extends "base.html" %}

{% block content %}

<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top shadow">
  <div class="container-fluid">
    <a class="navbar-brand fw-bold fs-3 text-dark" href="{% url 'task_list' %}">
      <i class="bi bi-list-task me-2 text-dark"></i>Lista de Tarefas com Django Framework
    </a>
    <div class="d-flex align-items-center ms-auto">
      <form class="d-flex me-2" method="get" action="{% url 'task_list' %}">
        <input class="form-control me-2 bg-light text-dark border" name="search" type="search" placeholder="Buscar tarefa" autocomplete="off" value="{{ request.GET.search|default:'' }}">
        <button class="btn btn-outline-dark" type="submit">
          <i class="bi bi-search"></i>
        </button>
      </form>
      <a href="{% url 'create_task' %}" class="btn btn-success">
        <i class="bi bi-plus-circle me-1"></i> Nova tarefa
      </a>
    </div>
  </div>
</nav>

<div style="height: 70px;"></div>

<div class="container d-flex justify-content-center mt-5">
  <div class="mx-auto wd-100" style="max-width: 1100px;">
    <div class="table-responsive">
      <table class="table table-hover align-middle border border-2">
        <thead class="table-dark" style="text-align: center;">
          <tr style="padding-left: 10px;">
            <th scope="col" class="px-3">#</th>
            <th scope="col" class="px-3">Título</th>
            <th scope="col" class="px-3">Descrição</th>
            <th scope="col" class="px-3">Data de criação</th>
            <th scope="col" class="px-3">Data de atualização</th>
            <th scope="col" class="px-3">Feito?</th>
            <th scope="col" class="px-3" class="text-center">Ações</th>
          </tr>
        </thead>
        <tbody>
          {% for task in tasks %}
          <tr>
            <th scope="row" class="px-3">{{forloop.counter}}</th>
            <td class="px-3">{{task.title}}</td>
            <td class="px-3">{{task.description}}</td>
            <td class="px-3">{{task.created_at|date:"d/m/Y H:i"}}</td>
            <td class="px-3">{{task.updated_at|date:"d/m/Y H:i"|default:"N/A"}}</td>
            <td class="px-3">
              {% if task.completed %}
                <span class="text-success px-3" title="Concluída">
                  <i class="bi bi-check-circle-fill"></i> 
                </span>
              {% else %}
                <span class="text-secondary px-3" title="Pendente">
                  <i class="bi bi-circle"></i>
                </span>
              {% endif %}
            </td>
            <td class="text-center px-3">
              <a href="{% url 'update_task' task.id %}" class="btn btn-success btn-sm">Editar</a>
              <a href="{% url 'delete_task' task.id %}" class="btn btn-danger btn-sm">Deletar</a>
            </td>
          </tr>
          {% empty %}
            <tr>
              {% if request.GET.search %}
                <td colspan="7" class="text-center">Nenhuma tarefa encontrada</td>
              {% else %}
                <td colspan="7" class="text-center">Nenhuma tarefa criada</td>
              {% endif %}
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
